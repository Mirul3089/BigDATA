{"paragraphs":[{"text":"%md\nMirul Patel (N01489347)","user":"anonymous","dateUpdated":"2022-10-11T16:23:14+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1665163135834_-1805363619","id":"20221007-171855_1219620718","dateCreated":"2022-10-07T17:18:55+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4219"},{"text":"%md\nKEY STEPS:\n\n1)I have read the data from HDFS\n2)Perfromed filtration and aggregation on data\n3)created new dataframe and stored the results of aggregation and then save/write that file into HDFS\n4)created a temporary views\n5)performed SQL queries like JOIN and various aggregation on that views for desire results","user":"anonymous","dateUpdated":"2022-10-11T16:22:53+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1665505352574_-1726660997","id":"20221011-162232_279312047","dateCreated":"2022-10-11T16:22:32+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5782"},{"text":"%spark2\n\nval ws = spark.read.option(\"header\",\"true\").option(\"inferSchema\", \"true\").csv(\"/tmp/worldsales.csv\")","user":"anonymous","dateUpdated":"2022-10-11T03:13:36+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":true},"editorMode":"ace/mode/scala","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ws: org.apache.spark.sql.DataFrame = [Id: int, Region: string ... 13 more fields]\n"}]},"apps":[],"jobName":"paragraph_1665163494464_-950514504","id":"20221007-172454_372070265","dateCreated":"2022-10-07T17:24:54+0000","dateStarted":"2022-10-11T03:05:49+0000","dateFinished":"2022-10-11T03:05:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4220"},{"text":"%spark2\nws.printSchema()","user":"anonymous","dateUpdated":"2022-10-11T03:05:54+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- Id: integer (nullable = true)\n |-- Region: string (nullable = true)\n |-- Country: string (nullable = true)\n |-- Item_Type: string (nullable = true)\n |-- Sales_Channel: string (nullable = true)\n |-- Order_Priority: string (nullable = true)\n |-- Order_Date: string (nullable = true)\n |-- Order_ID: integer (nullable = true)\n |-- Ship_Date: string (nullable = true)\n |-- Units_Sold: integer (nullable = true)\n |-- Unit_Price: double (nullable = true)\n |-- Unit_Cost: double (nullable = true)\n |-- Total_Revenue: double (nullable = true)\n |-- Total_Cost: double (nullable = true)\n |-- Total_Profit: double (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1665163547669_2108131982","id":"20221007-172547_306630738","dateCreated":"2022-10-07T17:25:47+0000","dateStarted":"2022-10-11T03:05:54+0000","dateFinished":"2022-10-11T03:05:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4221"},{"text":"%spark2\nws.head(5)","user":"anonymous","dateUpdated":"2022-10-10T18:56:07+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res6: Array[org.apache.spark.sql.Row] = Array([1,Middle East and North Africa,Libya,Cosmetics,Offline,M,10/18/2014,686800706,10/31/2014,8446,437.2,263.33,3692591.2,2224085.18,1468506.02], [2,North America,Canada,Vegetables,Online,M,11/7/2011,185941302,12/8/2011,3018,154.06,90.93,464953.08,274426.74,190526.34], [3,Middle East and North Africa,Libya,Baby Food,Offline,C,10/31/2016,246222341,12/9/2016,1517,255.28,159.42,387259.76,241840.14,145419.62], [4,Asia,Japan,Cereal,Offline,C,4/10/2010,161442649,5/12/2010,3322,205.7,117.11,683335.4,389039.42,294295.98], [5,Sub-Saharan Africa,Chad,Fruits,Offline,H,8/16/2011,645713555,8/31/2011,9845,9.33,6.92,91853.85,68127.4,23726.45])\n"}]},"apps":[],"jobName":"paragraph_1665163635970_138876553","id":"20221007-172715_1224798469","dateCreated":"2022-10-07T17:27:15+0000","dateStarted":"2022-10-10T18:56:08+0000","dateFinished":"2022-10-10T18:56:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4222"},{"text":"%spark2\nval wsfilter = ws.filter(ws(\"Units_Sold\") > 8000 and ws(\"Unit_Cost\") > 500).toDF(\"Id\",\n\"Region\",\"Country\",\"Item_Type\",\"Sales_Channel\",\"Order_Priority\",\"Order_Date\",\"Order_ID\",\"Ship_Date\",\"Units_Sold\",\"Unit_Price\",\"Unit_Cost\",\"Total_Revenue\",\"Total_Cost\",\"Total_Profit\")","user":"anonymous","dateUpdated":"2022-10-11T14:14:52+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"wsfilter: org.apache.spark.sql.DataFrame = [Id: int, Region: string ... 13 more fields]\n"}]},"apps":[],"jobName":"paragraph_1665163784215_-1891996707","id":"20221007-172944_1171780737","dateCreated":"2022-10-07T17:29:44+0000","dateStarted":"2022-10-11T14:14:52+0000","dateFinished":"2022-10-11T14:14:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4223"},{"text":"%spark2\nwsfilter.collect()","user":"anonymous","dateUpdated":"2022-10-11T14:15:12+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res26: Array[org.apache.spark.sql.Row] = Array([20,Sub-Saharan Africa,Senegal,Household,Offline,L,8/27/2012,247802054,9/8/2012,8989,668.27,502.54,6007079.03,4517332.06,1489746.97], [37,Sub-Saharan Africa,Swaziland,Office Supplies,Offline,H,10/3/2013,405785882,10/22/2013,9915,651.21,524.96,6456747.15,5204978.4,1251768.75])\n"}]},"apps":[],"jobName":"paragraph_1665460299580_1202947788","id":"20221011-035139_1505089040","dateCreated":"2022-10-11T03:51:39+0000","dateStarted":"2022-10-11T14:15:12+0000","dateFinished":"2022-10-11T14:15:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4224"},{"text":"%spark2\nval grouppbyresults = ws.groupBy(\"Region\").count().toDF(\"Region\",\"Count\")","user":"anonymous","dateUpdated":"2022-10-11T14:15:22+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"grouppbyresults: org.apache.spark.sql.DataFrame = [Region: string, Count: bigint]\n"}]},"apps":[],"jobName":"paragraph_1665163872071_-1505415484","id":"20221007-173112_1132018354","dateCreated":"2022-10-07T17:31:12+0000","dateStarted":"2022-10-11T14:15:23+0000","dateFinished":"2022-10-11T14:15:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4225"},{"text":"%spark2\ngrouppbyresults.collect()\n\n","user":"anonymous","dateUpdated":"2022-10-11T14:15:32+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res27: Array[org.apache.spark.sql.Row] = Array([Middle East and North Africa,6], [Australia and Oceania,2], [Europe,12], [Sub-Saharan Africa,15], [Central America and the Caribbean,6], [North America,3], [Asia,5])\n"}]},"apps":[],"jobName":"paragraph_1665428620920_-747206174","id":"20221010-190340_1719662969","dateCreated":"2022-10-10T19:03:40+0000","dateStarted":"2022-10-11T14:15:32+0000","dateFinished":"2022-10-11T14:15:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4226"},{"text":"%spark2\ngrouppbyresults.repartition(1).write.mode(\"overwrite\").option(\"header\",\"true\").csv(\"/tmp/subset.csv\")","user":"anonymous","dateUpdated":"2022-10-11T03:19:14+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1665429689982_-1469266012","id":"20221010-192129_1677130989","dateCreated":"2022-10-10T19:21:29+0000","dateStarted":"2022-10-11T03:19:14+0000","dateFinished":"2022-10-11T03:19:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4227"},{"text":"%spark2\ngrouppbyresults.createOrReplaceTempView(\"Regionview\")","user":"anonymous","dateUpdated":"2022-10-11T03:27:27+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1665458028946_2082987304","id":"20221011-031348_1831992192","dateCreated":"2022-10-11T03:13:48+0000","dateStarted":"2022-10-11T03:27:27+0000","dateFinished":"2022-10-11T03:27:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4228"},{"text":"%spark2\nws.createOrReplaceTempView(\"Salesview\")","user":"anonymous","dateUpdated":"2022-10-11T14:29:13+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1665458648901_22174792","id":"20221011-032408_1969089518","dateCreated":"2022-10-11T03:24:08+0000","dateStarted":"2022-10-11T14:29:13+0000","dateFinished":"2022-10-11T14:29:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4229"},{"text":"%spark2.sql\nSELECT * FROM Regionview","user":"anonymous","dateUpdated":"2022-10-11T14:36:44+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Region\tCount\nMiddle East and North Africa\t6\nAustralia and Oceania\t2\nEurope\t12\nSub-Saharan Africa\t15\nCentral America and the Caribbean\t6\nNorth America\t3\nAsia\t5\n"}]},"apps":[],"jobName":"paragraph_1665458902177_1260264460","id":"20221011-032822_1112979270","dateCreated":"2022-10-11T03:28:22+0000","dateStarted":"2022-10-11T03:46:11+0000","dateFinished":"2022-10-11T03:46:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4230"},{"text":"%spark2.sql\nSELECT Region, SUM(Units_sold) as Total_Unit_sale FROM Salesview\nGROUP BY Region","user":"anonymous","dateUpdated":"2022-10-11T14:29:25+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Region\tTotal_Unit_sale\nMiddle East and North Africa\t24273\nAustralia and Oceania\t5207\nEurope\t67424\nSub-Saharan Africa\t81582\nCentral America and the Caribbean\t30380\nNorth America\t10607\nAsia\t24189\n"}]},"apps":[],"jobName":"paragraph_1665459884294_-1159255572","id":"20221011-034444_565008863","dateCreated":"2022-10-11T03:44:44+0000","dateStarted":"2022-10-11T14:29:25+0000","dateFinished":"2022-10-11T14:29:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4231"},{"text":"%spark2.sql\nSELECT Region, SUM(total_profit) as TOTAL_PROFIT\nFROM Salesview\nGROUP BY Region","user":"anonymous","dateUpdated":"2022-10-11T14:30:18+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"stacked":false}},"commonSetting":{},"keys":[{"name":"Region","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"TOTAL_PROFIT","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Region\tTOTAL_PROFIT\nMiddle East and North Africa\t1953369.2600000002\nAustralia and Oceania\t325465.98\nEurope\t6015422.9399999995\nSub-Saharan Africa\t6548037.48\nCentral America and the Caribbean\t1570812.06\nNorth America\t246975.83000000002\nAsia\t553680.8999999999\n"}]},"apps":[],"jobName":"paragraph_1665460255623_-1729131634","id":"20221011-035055_207128058","dateCreated":"2022-10-11T03:50:55+0000","dateStarted":"2022-10-11T14:30:02+0000","dateFinished":"2022-10-11T14:30:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4232"},{"text":"%spark2.sql\nSELECT Region, SUM(total_profit) as PROFIT, SUM(total_revenue) as REVENUE, SUM(total_cost) as COST\nFROM Salesview\nGROUP BY Region\n\n","user":"anonymous","dateUpdated":"2022-10-11T14:31:04+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"lineChart","height":300,"optionOpen":false,"setting":{"lineChart":{"lineWithFocus":true,"forceY":false}},"commonSetting":{},"keys":[{"name":"Region","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"PROFIT","index":1,"aggr":"sum"},{"name":"REVENUE","index":2,"aggr":"sum"},{"name":"COST","index":3,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Region\tPROFIT\tREVENUE\tCOST\nMiddle East and North Africa\t1953369.2600000002\t5202480.26\t3249111.0000000005\nAustralia and Oceania\t325465.98\t801588.06\t476122.08\nEurope\t6015422.9399999995\t2.004863912E7\t1.403321618E7\nSub-Saharan Africa\t6548037.48\t2.8215024759999998E7\t2.166698728E7\nCentral America and the Caribbean\t1570812.06\t6342666.259999999\t4771854.199999999\nNorth America\t246975.83000000002\t645544.05\t398568.22\nAsia\t553680.8999999999\t1425821.1599999997\t872140.26\n"}]},"apps":[],"jobName":"paragraph_1665497393528_1024142638","id":"20221011-140953_1138400006","dateCreated":"2022-10-11T14:09:53+0000","dateStarted":"2022-10-11T14:30:49+0000","dateFinished":"2022-10-11T14:30:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4233"},{"text":"%spark2.sql\nSELECT s.Region, AVG(s.total_profit) as Average_Profit, r.Count\nFROM Salesview s\nJOIN Regionview r\nON r.Region=s.Region\nGROUP BY s.Region,r.Count","user":"anonymous","dateUpdated":"2022-10-11T16:02:24+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false,"setting":{"pieChart":{}},"commonSetting":{},"keys":[{"name":"Region","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"Average_Profit","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Region\tAverage_Profit\tCount\nAsia\t110736.17999999998\t5\nSub-Saharan Africa\t436535.83200000005\t15\nCentral America and the Caribbean\t261802.01\t6\nAustralia and Oceania\t162732.99\t2\nEurope\t501285.24499999994\t12\nMiddle East and North Africa\t325561.5433333334\t6\nNorth America\t82325.27666666667\t3\n"}]},"apps":[],"jobName":"paragraph_1665498028481_-1736709844","id":"20221011-142028_1276065030","dateCreated":"2022-10-11T14:20:28+0000","dateStarted":"2022-10-11T14:59:05+0000","dateFinished":"2022-10-11T14:59:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4234"},{"text":"%md\nBased on above query results:\n-Europe is the most profitable region\nAnd if company/customer want to open stores based on profit then the first choice should be Europe, followed by Middle East and North Africa and Central America and the Caribbean\n","user":"anonymous","dateUpdated":"2022-10-11T16:02:24+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1665500298752_-1418506656","id":"20221011-145818_1623948528","dateCreated":"2022-10-11T14:58:18+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:4235"}],"name":"Zeppelin-Spark Assignment Big Data 1","id":"2HDXW9GJR","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}